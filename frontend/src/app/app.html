<main class="main">
  <div class="container">
    <h1>EventSync</h1>

    <section>
      <h2>Create Event</h2>
      <input [(ngModel)]="newEvent.title" placeholder="Title" />
      <input [(ngModel)]="newEvent.description" placeholder="Description" />
      <button (click)="createEvent()" [disabled]="submittingEvent || !newEvent.title || !newEvent.description">Create</button>
    </section>

    <section>
      <h2>Events</h2>
      <ul>
        <li *ngFor="let event of events" (click)="selectEvent(event)" [class.selected]="selectedEvent?.id === event.id">
          <strong>{{ event.title }}</strong>: {{ event.description }}
        </li>
      </ul>
    </section>

    <section *ngIf="selectedEvent">
      <h2>Submit Feedback for {{ selectedEvent.title }}</h2>
      <textarea [(ngModel)]="feedbackText" placeholder="Your feedback..."></textarea>
      <button (click)="submitFeedback()" [disabled]="submittingFeedback || !feedbackText">Submit Feedback</button>
      <button (click)="getSummary(); showSummary = !showSummary">
        {{ showSummary ? 'Hide' : 'Show' }} Feedback Summary
      </button>
    </section>

    <section *ngIf="summary && showSummary">
      <h2>Feedback Summary</h2>
      <!-- Always visible scored sentiment bar -->
      <div style="background: #eee; border-radius: 8px; height: 24px; width: 100%; overflow: hidden;">
        <div
          [style.width.%]="getSentimentPercentage()"
          style="background: linear-gradient(90deg, #51a7f9, #a259f7); height: 100%; transition: width 0.5s;">
        </div>
      </div>
      <div style="text-align: right; font-size: 0.9em; color: #333; margin-top: 0.2em;">
        Feedback Positivity: {{ getSentimentPercentage() }}%
      </div>

      <!-- Hide/show detailed bars -->
      <button (click)="showBars = !showBars" style="margin-bottom: 1rem;">
        {{ showBars ? 'Hide' : 'Show' }} More Details
      </button>
      <div *ngIf="showBars">
        <div style="margin-bottom: 1rem;">
          <div style="background: #eee; border-radius: 8px; height: 24px; width: 100%; overflow: hidden;">
            <div
              [style.width.%]="getPositivePercentage()"
              style="background: linear-gradient(90deg, #51a7f9, #a259f7); height: 100%; transition: width 0.5s;">
            </div>
          </div>
          <div style="text-align: right; font-size: 0.9em; color: #333; margin-top: 0.2em;">
            Positive: {{ getPositivePercentage() }}% ({{ summary['Positive'] || 0 }})
          </div>
        </div>
        <div style="margin-bottom: 1rem;">
          <div style="background: #eee; border-radius: 8px; height: 24px; width: 100%; overflow: hidden;">
            <div
              [style.width.%]="getNeutralPercentage()"
              style="background: linear-gradient(90deg, #51a7f9, #a259f7); height: 100%; transition: width 0.5s;">
            </div>
          </div>
          <div style="text-align: right; font-size: 0.9em; color: #333; margin-top: 0.2em;">
            Neutral: {{ getNeutralPercentage() }}% ({{ summary['Neutral'] || 0 }})
          </div>
        </div>
        <div style="margin-bottom: 1rem;">
          <div style="background: #eee; border-radius: 8px; height: 24px; width: 100%; overflow: hidden;">
            <div
              [style.width.%]="getNegativePercentage()"
              style="background: linear-gradient(90deg, #51a7f9, #a259f7); height: 100%; transition: width 0.5s;">
            </div>
          </div>
          <div style="text-align: right; font-size: 0.9em; color: #333; margin-top: 0.2em;">
            Negative: {{ getNegativePercentage() }}% ({{ summary['Negative'] || 0 }})
          </div>
        </div>
      </div>
    </section>
    <div *ngIf="message" class="message" [ngClass]="{'message-success': messageType === 'success', 'message-error': messageType === 'error'}">{{ message }}</div>
  </div>
</main>